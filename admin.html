<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Panel</title>
<style>
body {
	margin: 0;
	padding: 0;
	min-height: 100vh;
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	background-color: #f9fafd;
	color: #333;
}

h1 {
	text-align: center;
	color: #2c3e50;
	margin-bottom: 40px;
	letter-spacing: 1px;
}

.container {
	display: flex;
	gap: 24px;
}

.panel {
	flex: 1;
	background: #fff;
	border-radius: 8px;
	box-shadow: 0 4px 10px rgba(0,0,0,0.1);
	padding: 20px;
	display: flex;
	flex-direction: column;
}

.panel h2 {
	margin-top: 0;
	margin-bottom: 16px;
	color: #34495e;
	border-bottom: 2px solid #2980b9;
	padding-bottom: 6px;
}

table {
	width: 100%;
	border-collapse: separate;
	border-spacing: 0 8px;
}

th, td {
	padding: 12px 16px;
	text-align: left;
	font-size: 1rem;
}

thead th {
	background-color: #2980b9;
	color: #fff;
	font-weight: 600;
	text-transform: uppercase;
	letter-spacing: 0.05em;
	border-radius: 4px 4px 0 0;
}

tbody tr {
	background-color: #ecf0f1;
	transition: background-color 0.3s ease;
}

tbody tr:hover {
	background-color: #d6eaf8;
}

tbody td {
	border-top: 1px solid #ddd;
}

tbody tr td[colspan] {
	text-align: center;
	font-style: italic;
	color: #7f8c8d;
}

.home-btn {
	display: inline-block;
	position: absolute;
	left: 32px;
	top: 32px;
	margin: 0;
	padding: 10px 28px;
	background: #2980b9;
	color: #fff;
	border-radius: 6px;
	text-decoration: none;
	font-weight: 600;
	letter-spacing: 0.5px;
	transition: 0.2s;
	box-shadow: 0 2px 8px rgba(41,128,185,0.08);
	z-index: 10;
}

.home-btn:hover {
	background: hsl(205, 67%, 33%);
}

@media (max-width: 900px) {
	.container {
		flex-direction: column;
	}

	.panel {
		margin-bottom: 24px;
	}
}

@media (max-width: 600px) {
	table, thead, tbody, th, td, tr {
		display: block;
	}

	thead tr {
		display: none;
	}

	tbody tr {
		margin-bottom: 20px;
		background: #fff;
		box-shadow: 0 2px 6px rgba(0,0,0,0.1);
		border-radius: 8px;
		padding: 12px 16px;
	}

	tbody td {
		border: none;
		padding-left: 50%;
		position: relative;
		text-align: right;
		font-size: 0.95rem;
	}

	tbody td::before {
		position: absolute;
		left: 16px;
		width: 45%;
		white-space: nowrap;
		font-weight: 600;
		text-align: left;
		color: #2980b9;
	}
    
 
	#contactsTable tbody td:nth-child(1)::before {
		content: "Name";
	}

	#contactsTable tbody td:nth-child(2)::before {
		content: "Email";
	}

	#contactsTable tbody td:nth-child(3)::before {
		content: "Message";
	}

	#appointmentsTable tbody td:nth-child(1)::before {
		content: "Name";
	}

	#appointmentsTable tbody td:nth-child(2)::before {
		content: "PESEL";
	}

	#appointmentsTable tbody td:nth-child(3)::before {
		content: "Specialty";
	}

	#appointmentsTable tbody td:nth-child(4)::before {
		content: "Doctor";
	}

	#appointmentsTable tbody td:nth-child(5)::before {
		content: "Date";
	}

	#appointmentsTable tbody td:nth-child(6)::before {
		content: "Time";
	}
}

.login-modal {
	position: fixed;
	inset: 0;
	z-index: 1000;
	background: linear-gradient(135deg, rgba(66, 147, 233, 0.9), rgba(52, 219, 216, 0.9));
	display: flex;
	align-items: center;
	justify-content: center;
	backdrop-filter: blur(10px);
	min-height: 100vh;
	padding: 20px;
	box-sizing: border-box;
}

.login-container {
	background: rgba(255, 255, 255, 0.95);
	padding: 2.5rem 3rem;
	border-radius: 20px;
	box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
	width: 100%;
	max-width: 400px;
	position: relative;
	overflow: hidden;
	margin: auto;
	transform: translateY(0);
	transition: transform 0.3s ease;
}

.login-container::before {
	content: '';
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 5px;
	background: linear-gradient(to right, #4293e9, #34dbd8);
}

.login-header {
	text-align: center;
	margin-bottom: 1.5rem;
}

.login-title {
	color: #1a365d;
	font-size: 2rem;
	font-weight: 700;
	margin: 0;
	letter-spacing: -0.5px;
}

.login-subtitle {
	color: #64748b;
	font-size: 0.95rem;
	margin-top: 0.5 rem;
}

.form-group {
	margin-bottom: 1.5rem;
	position: relative;
}

.form-group label {
	display: block;
	color: #475569;
	font-size: 0.9rem;
	font-weight: 500;
	margin-bottom: 0.75rem;
	padding-left: px;
}

.form-control {
	width: 83%;
	height: 3.25rem;
	padding: 0 1rem 0 3rem;
	background: #f8fafc;
	border: 3px solid #e2e8f0;
	border-radius: 12px;
	font-size: 0.95rem;
	color: #1e293b;
	transition: all 0.3s ease;
}

.form-control:focus {
	outline: none;
	border-color: #4293e9;
	background: #fff;
	box-shadow: 0 0 0 4px rgba(66, 147, 233, 0.1);
}

.form-icon {
	position: absolute;
	left: 1rem;
	top: 3rem;
	width: 20px;
	height: 20px;
	color: #94a3b8;
	transition: all 0.3s ease;
	pointer-events: none;
}

.form-group:focus-within .form-icon {
	color: #4293e9;
}

.login-btn {
	width: 100%;
	padding: 1rem;
	background: linear-gradient(135deg, #4293e9, #34dbd8);
	color: #fff;
	border: none;
	border-radius: 12px;
	font-weight: 600;
	font-size: 1rem;
	cursor: pointer;
	transition: all 0.3s ease;
	margin-top: 1rem;
}

.login-btn:hover {
	transform: translateY(-2px);
	box-shadow: 0 10px 20px rgba(66, 147, 233, 0.2);
}

.login-btn:active {
	transform: translateY(0);
}

.login-error {
	background: #fee2e2;
	color: #dc2626;
	padding: 0.75rem 1rem;
	border-radius: 8px;
	font-size: 0.9rem;
	margin-top: 1rem;
	display: none;
	text-align: center;
	animation: shake 0.5s ease-in-out;
}

@keyframes shake {
	0%, 100% { transform: translateX(0); }
	25% { transform: translateX(-5px); }
	75% { transform: translateX(5px); }
}

.form-control::placeholder {
	color: #94a3b8;
	opacity: 0.8;
}
</style>
</head>
<body>
    
      <div id="loginModal" class="login-modal" style="display: none;">
    <div class="login-container">
        <div class="login-header">
            <h2 class="login-title">Welcome Back</h2>
            <p class="login-subtitle">Please sign in to continue</p>
        </div>
        <form id="loginForm">
            <div class="form-group">
                <label for="adminUser">Username</label>
                <svg class="form-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16.6667 17.5V15.8333C16.6667 14.9493 16.3155 14.1014 15.6904 13.4763C15.0653 12.8512 14.2174 12.5 13.3333 12.5H6.66668C5.78262 12.5 4.93478 12.8512 4.30965 13.4763C3.68453 14.1014 3.33334 14.9493 3.33334 15.8333V17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 9.16667C11.841 9.16667 13.3333 7.67428 13.3333 5.83333C13.3333 3.99238 11.841 2.5 10 2.5C8.15906 2.5 6.66667 3.99238 6.66667 5.83333C6.66667 7.67428 8.15906 9.16667 10 9.16667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <input type="text" id="adminUser" class="form-control" required placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label for="adminPass">Password</label>
                <svg class="form-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.8333 9.16667H4.16667C3.24619 9.16667 2.5 9.91286 2.5 10.8333V16.6667C2.5 17.5871 3.24619 18.3333 4.16667 18.3333H15.8333C16.7538 18.3333 17.5 17.5871 17.5 16.6667V10.8333C17.5 9.91286 16.7538 9.16667 15.8333 9.16667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M5.83334 9.16667V5.83333C5.83334 4.72827 6.27233 3.66846 7.05373 2.88706C7.83513 2.10566 8.89494 1.66667 10 1.66667C11.1051 1.66667 12.1649 2.10566 12.9463 2.88706C13.7277 3.66846 14.1667 4.72827 14.1667 5.83333V9.16667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <input type="password" id="adminPass" class="form-control" required placeholder="Enter your password">
            </div>
            <button type="submit" class="login-btn">Sign In</button>
            <div id="loginError" class="login-error">Invalid credentials. Please try again.</div>
        </form>
    </div>
</div>
  
  <h1>Admin Panel</h1>
  <button id="logoutBtn" style="display:none;position:absolute;top:32px;right:32px;z-index:1001;padding:10px 24px;background:#c0392b;color:#fff;border:none;border-radius:6px;font-weight:600;cursor:pointer;">Logout</button>
   <a href="index.html" class="home-btn">Home</a>
  <div class="container">
    <section class="panel">
      <h2>Contact Messages</h2>
      <table id="contactsTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Message</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan="3">Loading...</td></tr>
        </tbody>
      </table>
    </section>

    <section class="panel">
      <h2>Appointments</h2>
      <table id="appointmentsTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>PESEL</th>
            <th>Specialty</th>
            <th>Doctor</th>
            <th>Date</th>
            <th>Time</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan="6">Loading...</td></tr>
        </tbody>
      </table>
    </section>
  </div>

  <script>
window.addEventListener('DOMContentLoaded', function() {
  if (localStorage.getItem("adminLoggedIn") === "true") {
    document.getElementById('loginModal').style.display = "none";
    document.getElementById('logoutBtn').style.display = "block"; 
  } else {
    document.getElementById('loginModal').style.display = "flex";
    document.getElementById('logoutBtn').style.display = "none";
  }
});

// Login form submission
document.getElementById('loginForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const user = document.getElementById('adminUser').value.trim();
  const pass = document.getElementById('adminPass').value;
  if (user === "admin" && pass === "admin123") {
    localStorage.setItem("adminLoggedIn", "true");
    document.getElementById('loginModal').style.display = "none";
    document.getElementById('loginError').style.display = "none";
    document.getElementById('logoutBtn').style.display = "block"; 
  } else {
    document.getElementById('loginError').style.display = "block";
  }
});
    
    // Fetch contact messages
    fetch('http://localhost:3000/api/contacts')
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector("#contactsTable tbody");
        tbody.innerHTML = "";
        if (data.length === 0) {
          tbody.innerHTML = "<tr><td colspan='3'>No records found.</td></tr>";
        } else {
data.forEach(c => {
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td data-label="Name">${c.name || ""}</td>
    <td data-label="Email">${c.email || ""}</td>
    <td data-label="Message">${c.message || ""}</td>
    <td>
      ${c.id ? `<button class="delete-contact-btn" data-id="${c.id}">Delete</button>` : ""}
    </td>
  `;
  tbody.appendChild(tr);
});
        }
      })
      .catch(() => {
        document.querySelector("#contactsTable tbody").innerHTML = "<tr><td colspan='3'>Failed to load data.</td></tr>";
      });

    // Fetch appointments
    fetch('http://localhost:3000/api/appointments')
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector("#appointmentsTable tbody");
        tbody.innerHTML = "";
        if (data.length === 0) {
          tbody.innerHTML = "<tr><td colspan='6'>No records found.</td></tr>";
        } else {
          data.forEach(a => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td data-label="ID">${a.id || ""}</td>
              <td data-label="Name">${a.patientName || ""}</td>
              <td data-label="PESEL">${a.pesel || ""}</td>
            <td data-label="Specialty">${(a.specialty || "").replace(/_/g, ' ')}</td>
              <td data-label="Doctor">${a.doctor || ""}</td>
              <td data-label="Date">${a.date || ""}</td>
              <td data-label="Time">${a.time || ""}</td>
                  <td>
            <button class="edit-btn" data-id="${a.id}">Edit</button>
            <button class="delete-btn" data-id="${a.id}">Delete</button>
                 </td>
            `;
            tbody.appendChild(tr);
          });
        }
      })
      .catch(() => {
        document.querySelector("#appointmentsTable tbody").innerHTML = "<tr><td colspan='6'>Failed to load data.</td></tr>";
      });

   document.getElementById('loginForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const user = document.getElementById('adminUser').value.trim();
  const pass = document.getElementById('adminPass').value;
  if (user === "admin" && pass === "admin123") {
    localStorage.setItem("adminLoggedIn", "true");
    document.getElementById('loginModal').style.display = "none";
    document.getElementById('loginError').style.display = "none";
  } else {
    document.getElementById('loginError').style.display = "block";
  }
});

   document.addEventListener('click', function(e) {

  if (e.target.classList.contains('edit-btn')) {
    const btn = e.target;
    const tr = btn.closest('tr');
    if (!tr) return;
    if (tr.classList.contains('editing')) return;
    tr.classList.add('editing');


    const tds = tr.querySelectorAll('td');
    const original = Array.from(tds).map(td => td.innerText);

    const fields = ['patientName', 'pesel', 'specialty', 'doctor', 'date', 'time'];
    const id = btn.dataset.id;

    for (let i = 1; i <= 6; i++) {
      const val = tds[i].innerText;
      tds[i].innerHTML = `<input type="text" value="${val}" style="width:95%;">`;
    }

    // Update Actions
    tds[7].innerHTML = `
      <button class="save-btn" data-id="${id}">Save</button>
      <button class="cancel-btn">Cancel</button>
    `;

    // Cancel
    tds[7].querySelector('.cancel-btn').onclick = function() {
      tr.classList.remove('editing');
      fields.forEach((_, i) => tds[i+1].innerText = original[i+1]);
      tds[7].innerHTML = `
        <button class="edit-btn" data-id="${id}">Edit</button>
        <button class="delete-btn" data-id="${id}">Delete</button>
      `;
    };

    // Save
    tds[7].querySelector('.save-btn').onclick = function() {
      const updated = {};
      fields.forEach((field, i) => {
        updated[field] = tds[i+1].querySelector('input').value.trim();
      });
      updated.id = id;

      fetch(`http://localhost:3000/api/appointments/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(updated)
      })
      .then(res => {
        if (res.ok) {
          location.reload();
        } else {
          alert("Güncelleme başarısız!");
        }
      });
    };
  }
});

document.getElementById('logoutBtn').addEventListener('click', function() {
  localStorage.removeItem("adminLoggedIn");
  location.reload();
});

document.addEventListener('click', function(e) {
  if (e.target.classList.contains('delete-btn')) {
    const id = e.target.dataset.id;
    if (confirm("Are you sure you want to delete this appointment?")) {
      fetch(`http://localhost:3000/api/appointments/${id}`, {
        method: "DELETE"
      })
      .then(res => {
        if (res.ok) {
          location.reload();
        } else {
          alert("Deleteion failed!");
        }
      });
    }
  }
});

document.addEventListener('click', function(e) {
  if (e.target.classList.contains('delete-contact-btn')) {
    const id = e.target.dataset.id;
    if (confirm("Are you sure you want to delete this message?")) {
      fetch(`http://localhost:3000/api/contacts/${id}`, {
        method: "DELETE"
      })
      .then(res => {
        if (res.ok) {
          location.reload();
        } else {
          alert("Delete failed!");
        }
      });
    }
  }
});
  </script>
</body>
</html>
